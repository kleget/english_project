# –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ database_operations.py

## üìã –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞

–§–∞–π–ª `database_operations.py` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö SQLite. –û–Ω —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ 4 –æ—Å–Ω–æ–≤–Ω—ã–µ —á–∞—Å—Ç–∏:

1. **–ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î** (—Å—Ç—Ä–æ–∫–∏ 9-54)
2. **–°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü** (—Å—Ç—Ä–æ–∫–∏ 58-122)
3. **–†–∞–±–æ—Ç–∞ —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏** (—Å—Ç—Ä–æ–∫–∏ 124-339)
4. **–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** (—Å—Ç—Ä–æ–∫–∏ 341-353)

---

## üîß –ß–∞—Å—Ç—å 1: –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î

### `create_table(db_name, table_name)`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –°–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–∞–ø–∫–∞ `database`, –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞—ë—Ç
- –î–æ–±–∞–≤–ª—è–µ—Ç `.db` –∫ –∏–º–µ–Ω–∏ –ë–î, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
- –í—ã–±–∏—Ä–∞–µ—Ç —Å—Ö–µ–º—É —Ç–∞–±–ª–∏—Ü—ã:
  - –î–ª—è `from_all_files`: `id, deleted_word, count, merged_to`
  - –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö: `id, word, count`
- –°–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É, –µ—Å–ª–∏ –µ—ë –µ—â—ë –Ω–µ—Ç

**–ü—Ä–∏–º–µ—Ä:**
```python
create_table('biology', '–∫–Ω–∏–≥–∞_1')  # –°–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É –≤ biology.db
```

---

### `insert_many_into_table(db_name, table_name, data)`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –í—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–≥–æ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü—É –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∏–º—è –ë–î (–¥–æ–±–∞–≤–ª—è–µ—Ç `.db`)
2. –°–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
3. –í—ã–±–∏—Ä–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç –≤—Å—Ç–∞–≤–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ç–∞–±–ª–∏—Ü—ã
4. –£–¥–∞–ª—è–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã –∏–∑ –¥–∞–Ω–Ω—ã—Ö (–∏—Å–ø–æ–ª—å–∑—É—è `set`)
5. –í—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º

**–ü—Ä–∏–º–µ—Ä:**
```python
data = [['hello', 100], ['world', 50]]
insert_many_into_table('biology', '–∫–Ω–∏–≥–∞_1', data)
```

---

### `select_from_table(db_name, request)`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –í—ã–ø–æ–ª–Ω—è–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ë–î
- –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π SQL-–∑–∞–ø—Ä–æ—Å
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü –∏–∑ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**–ü—Ä–∏–º–µ—Ä:**
```python
words = select_from_table('biology', 'SELECT word FROM –∫–Ω–∏–≥–∞_1')
```

---

## üìä –ß–∞—Å—Ç—å 2: –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü

### `create_intersection_table_query(tables, db_path, result_table)`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –°–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É `word_intersection` ‚Äî —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å **–≤–æ –≤—Å–µ—Ö** –∫–Ω–∏–≥–∞—Ö.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ë–î
2. –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—É—é —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è
3. –ù–∞—Ö–æ–¥–∏—Ç —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü–µ:
   - –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å –ø–æ–º–µ—Ç–∫–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫–∞
   - –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ —Å–ª–æ–≤—É –∏ —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
   - –û—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
4. –°—É–º–º–∏—Ä—É–µ—Ç —á–∞—Å—Ç–æ—Ç—É (`count`) –¥–ª—è —ç—Ç–∏—Ö —Å–ª–æ–≤
5. –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏

**–ü—Ä–∏–º–µ—Ä:**
–ï—Å–ª–∏ –≤ `biology.db` –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü—ã:
- `–∫–Ω–∏–≥–∞_1`: hello (100), world (50), test (30)
- `–∫–Ω–∏–≥–∞_2`: hello (80), world (60), python (40)

–†–µ–∑—É–ª—å—Ç–∞—Ç `word_intersection`:
- hello (180) ‚Äî –µ—Å—Ç—å –≤ –æ–±–µ–∏—Ö –∫–Ω–∏–≥–∞—Ö
- world (110) ‚Äî –µ—Å—Ç—å –≤ –æ–±–µ–∏—Ö –∫–Ω–∏–≥–∞—Ö

---

### `create_translations_table(cursor, table_name)`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –°–æ–∑–¥–∞—ë—Ç –ª–æ–∫–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –≤ –Ω–∞—É—á–Ω–æ–π –ë–î.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:**
- `word` (PRIMARY KEY) ‚Äî —Å–ª–æ–≤–æ
- `count` ‚Äî —á–∞—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `translation` ‚Äî –ø–µ—Ä–µ–≤–æ–¥

**–ó–∞—á–µ–º:** –•—Ä–∞–Ω–∏—Ç –ø–µ—Ä–µ–≤–æ–¥—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–ª–æ–≤ —ç—Ç–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –Ω–∞—É–∫–∏.

---

## üåê –ß–∞—Å—Ç—å 3: –†–∞–±–æ—Ç–∞ —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏

### `create_union_table_query(tables, db_path, result_table, translation_threshold)`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –°–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É `global_union` ‚Äî –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–ª–æ–≤ –∏–∑ –≤—Å–µ—Ö –∫–Ω–∏–≥ + –ø–µ—Ä–µ–≤–æ–¥—ã.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ—à–∞–≥–æ–≤–æ):**

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—É—é `global_union` (–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç `translations`)
- –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é `global_union` (word, count)
- –°–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É `translations` (–µ—Å–ª–∏ –µ—ë –Ω–µ—Ç)

#### –®–∞–≥ 2: –°–±–æ—Ä –≤—Å–µ—Ö —Å–ª–æ–≤
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∫–Ω–∏–≥
- –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –ø–æ —Å–ª–æ–≤—É –∏ —Å—É–º–º–∏—Ä—É–µ—Ç `count`
- –°–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ —á–∞—Å—Ç–æ—Ç–µ (–æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É)

#### –®–∞–≥ 3: –í—ã–±–æ—Ä —Å–ª–æ–≤ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞
- –ë–µ—Ä—ë—Ç —Ç–æ–ø N% —Å–ª–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 25%)
- –ù–∞–ø—Ä–∏–º–µ—Ä: –µ—Å–ª–∏ 1000 —Å–ª–æ–≤, –ø–µ—Ä–µ–≤–µ–¥—ë—Ç —Ç–æ–ø 250

#### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–∞
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∫–∞–∫–∏–µ —Å–ª–æ–≤–∞ —É–∂–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤ `translations_cache.db`
- –†–∞–∑–¥–µ–ª—è–µ—Ç —Å–ª–æ–≤–∞ –Ω–∞:
  - **–í –∫—ç—à–µ** ‚Äî —É–∂–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã
  - **–ù–µ –≤ –∫—ç—à–µ** ‚Äî –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏

#### –®–∞–≥ 5: –ü–µ—Ä–µ–≤–æ–¥ –Ω–æ–≤—ã—Ö —Å–ª–æ–≤
- –ü–µ—Ä–µ–≤–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ –∫—ç—à–µ
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫—ç—à
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –∫—ç—à –∏ –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã

#### –®–∞–≥ 6: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- –û–±–Ω–æ–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É `translations` –≤ –Ω–∞—É—á–Ω–æ–π –ë–î
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –ø–µ—Ä–µ–≤–æ–¥—ã (–∏–∑ –∫—ç—à–∞ + –Ω–æ–≤—ã–µ) —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º `count`

**–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:**
```
–û–±—Ä–∞–±–æ—Ç–∫–∞ biology.db:
1. –ù–∞–π–¥–µ–Ω–æ 1000 —Å–ª–æ–≤
2. –í—ã–±—Ä–∞–Ω–æ —Ç–æ–ø 250 –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞: 200 —Å–ª–æ–≤ —É–∂–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã
4. –ü–µ—Ä–µ–≤–µ–¥–µ–Ω–æ 50 –Ω–æ–≤—ã—Ö —Å–ª–æ–≤
5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ 250 –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –≤ biology.db/translations
6. –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ 50 –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –≤ translations_cache.db
```

---

### –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫—ç—à –ø–µ—Ä–µ–≤–æ–¥–æ–≤

#### `get_global_translations_cache_path()`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Ç—å –∫ `database/translations_cache.db` ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É –∫—ç—à—É.

#### `init_global_translations_cache()`
–°–æ–∑–¥–∞—ë—Ç –ë–î –∫—ç—à–∞, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç. –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
- `word` (PRIMARY KEY)
- `translation`

#### `get_cached_translations(words)`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∫–∞–∫–∏–µ —Å–ª–æ–≤–∞ —É–∂–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º –∫—ç—à–µ.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫—ç—à (–µ—Å–ª–∏ –Ω–µ—Ç)
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å: `SELECT word, translation FROM translations_cache WHERE word IN (...)`
3. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å `{word: translation}`

**–ü—Ä–∏–º–µ—Ä:**
```python
words = ['hello', 'world', 'python']
cached = get_cached_translations(words)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: {'hello': '–ø—Ä–∏–≤–µ—Ç', 'world': '–º–∏—Ä'}  # python –Ω–µ—Ç –≤ –∫—ç—à–µ
```

#### `save_to_global_translations_cache(translations)`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—ã –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫—ç—à.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `INSERT OR IGNORE` ‚Äî –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã (–Ω–µ –ø—É—Å—Ç—ã–µ, –Ω–µ "‚Äî")

---

## üîç –ß–∞—Å—Ç—å 4: –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### `get_word_with_translation(cursor, word, union_table)`
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:** –ü–æ–ª—É—á–∞–µ—Ç —Å–ª–æ–≤–æ –∏–∑ `global_union` —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º (–µ—Å–ª–∏ –µ—Å—Ç—å).

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –í—ã–ø–æ–ª–Ω—è–µ—Ç LEFT JOIN –º–µ–∂–¥—É `global_union` –∏ `translations`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `(word, count, translation)` –∏–ª–∏ `None`

**–ü—Ä–∏–º–µ—Ä:**
```python
result = get_word_with_translation(cursor, 'hello')
# –†–µ–∑—É–ª—å—Ç–∞—Ç: ('hello', 180, '–ø—Ä–∏–≤–µ—Ç')
```

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### 1. –î–≤–µ —Å–∏—Å—Ç–µ–º—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫—ç—à** (`translations_cache.db`):
- –û–¥–∏–Ω –¥–ª—è –≤—Å–µ—Ö –Ω–∞—É–∫
- –°–ª–æ–≤–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å–µ–º–∏ –ë–î (biology, physics, math...)

**–õ–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à** (`translations` –≤ –∫–∞–∂–¥–æ–π –ë–î):
- –¢–æ–ª—å–∫–æ –¥–ª—è —Å–ª–æ–≤ —ç—Ç–æ–π –Ω–∞—É–∫–∏
- –°–æ–¥–µ—Ä–∂–∏—Ç `count` –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –±–µ–∑ JOIN

### 2. –ü–æ—á–µ–º—É –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤?

- **–≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞:** –Ω–µ —Ö—Ä–∞–Ω–∏–º NULL –¥–ª—è 3/4 —Å–ª–æ–≤
- **–ì–∏–±–∫–æ—Å—Ç—å:** –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –º–µ–Ω—å—à–∏–π —Ä–∞–∑–º–µ—Ä `global_union`

### 3. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

```
–ü–µ—Ä–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (biology.db):
- 1000 —Å–ª–æ–≤ ‚Üí –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ 250 ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –∫—ç—à

–í—Ç–æ—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (physics.db):
- 1000 —Å–ª–æ–≤ ‚Üí 200 –∏–∑ –∫—ç—à–∞ ‚Üí –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ 50 ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –∫—ç—à
- –≠–∫–æ–Ω–æ–º–∏—è: 200 –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –Ω–µ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–∏ API-–∑–∞–ø—Ä–æ—Å–æ–≤!
```

---

## üìà –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
–ö–Ω–∏–≥–∏ ‚Üí –¢–∞–±–ª–∏—Ü—ã –≤ –ë–î ‚Üí global_union ‚Üí –í—ã–±–æ—Ä —Ç–æ–ø N% ‚Üí 
‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–∞ ‚Üí –ü–µ—Ä–µ–≤–æ–¥ –Ω–æ–≤—ã—Ö ‚Üí 
‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫—ç—à ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **–î—É–±–ª–∏–∫–∞—Ç—ã —É–¥–∞–ª—è—é—Ç—Å—è** –≤ `insert_many_into_table` —á–µ—Ä–µ–∑ `set`
2. **–ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫—ç—à –Ω–µ —É–¥–∞–ª—è–µ—Ç—Å—è** –ø—Ä–∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–∏ `global_union`
3. **–ü–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–ø N%** —Å–ª–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 25%)
4. **–ö—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–∂–¥—É –ë–î** ‚Äî –ø–µ—Ä–µ–≤–æ–¥—ã –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è

---

## üîó –°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏

- `translation_utils.py` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è `translate_batch()` –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞
- `config.py` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- `main.py` ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞

